<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <style>
        [vclock] {
            display: none;
        }

        a {
            text-decoration: none;
        }

        .elposition {
            /* position: fixed; */
            /* bottom: 0; */
            /* border: 1px solid pink; */
            /* display: flex; */
            /* flex-wrap: nowrap; */
            justify-content: space-around;
            /* height: 100%; */
            /* width: 100%; */
        }

        .all-item {
            width: 100%;
            border: 1px dotted pink;
            text-align: center;

            /* display: flex; */
            /* justify-content: space-around; */
        }

        .itembox {
            display: inline-block;
            text-align: center;
            margin: 0.1rem;
            /* padding-left: 1rem;
            padding-right: 1rem; */
            /* padding-bottom: 1rem; */
            vertical-align: middle;
            margin-top: .5rem;
            /* border: 1px solid red; */
            border-bottom: .5px dotted pink;
        }

        .imgwid {
            display: block;
            height: 5rem;
            /* width: 5rem; */
            /* height: 8rem; */
        }
    </style>
</head>

<body>
    <div id="app" v-cloak>
        <el-tabs class="elposition" :tab-position="tabPosition" type="border-card">
            <el-tab-pane label="视频播放" @select="handleSelect">视频播放</el-tab-pane>
            <el-tab-pane label="视频列表" @select="handleSelect">
                <div class="all-item">
                    <a class="itembox" v-for="(item, index) in videolist" :key="index" :href="item.playurl">
                        <img class="imgwid" :src="item.picurl" :alt="item.videoname">
                        <el-link type="primary">{{item.videoname}}</el-link>
                    </a>
                </div>
            </el-tab-pane>

        </el-tabs>
    </div>
</body>
<!-- import Vue before Element -->
<script src="https://cdn.bootcdn.net/ajax/libs/vue/2.7.4/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>
    new Vue({
        el: '#app',
        data: function () {
            return {
                activeName: 'first',
                tabPosition: 'top',
                videolist: []
            }
        },
        methods: {
            handleSelect() {

            },
            /* 
            解密字符串
            */
            fromCode(str) {
                //定义密钥，36个字母和数字
                var key = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                var l = key.length;  //获取密钥的长度
                var b, b1, b2, b3, d = 0, s;  //定义临时变量
                s = new Array(Math.floor(str.length / 3));  //计算加密字符串包含的字符数，并定义数组
                b = s.length;  //获取数组的长度
                for (var i = 0; i < b; i++) {  //以数组的长度循环次数，遍历加密字符串
                    b1 = key.indexOf(str.charAt(d));  //截取周期内第一个字符串，计算在密钥中的下标值
                    d++;
                    b2 = key.indexOf(str.charAt(d));  //截取周期内第二个字符串，计算在密钥中的下标值
                    d++;
                    b3 = key.indexOf(str.charAt(d));  //截取周期内第三个字符串，计算在密钥中的下标值
                    d++;
                    s[i] = b1 * l * l + b2 * l + b3  //利用下标值，反推被加密字符的Unicode编码值
                }
                b = eval("String.fromCharCode(" + s.join(',') + ")"); //用fromCharCode()算出字符串
                return b;  //返回被解密的字符串
            },
            getU3U8data() {
                let url = 'https://www.fastmock.site/mock/6b7712f199a943a7520ffedededab652/getm3u8url/api/geturl';
                let requestInstace = new Request(url, {
                    method: 'post',
                    headers: {
                        'Content-Type': 'application/json;charset=utf-8'
                    },
                });

                fetch(requestInstace).then(response => {
                    let result = response.json();
                    result.then(res => {

                        res.forEach(element => {
                            // confirm(JSON.stringify(element));
                            let obj = {
                                "videoname": this.fromCode(element.videoname),
                                "playurl": this.fromCode(element.playurl),
                                "picurl": this.fromCode(element.picurl)
                            };
                            this.videolist.push(obj);
                        });

                    }).then(res => {
                        console.log(this.videolist);
                    })
                })
            }
        },
        mounted() {
            this.getU3U8data();
        },

    })
</script>

</html>